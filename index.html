<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="no-referrer">
    <title>SportsPro Web | Live Channel</title>
    
    <!-- Shaka Player CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.7.1/controls.min.css" crossorigin="anonymous">
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #000;
            color: #fff;
            overflow-x: hidden;
            position: relative;
            height: 100vh;
        }
        
        /* Watermark */
        .watermark {
            position: fixed;
            top: 15px;
            left: 15px;
            width: 120px;
            opacity: 0.7;
            pointer-events: none;
            z-index: 100;
        }
        
        /* Player container */
        .player-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }
        
        #video {
            width: 100%;
            height: 100%;
            display: block;
        }
        
        /* Video placeholder for initial state */
        .video-placeholder {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #0c2461, #1e3799);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 20px;
            z-index: 2;
        }
        
        .video-placeholder i {
            font-size: 80px;
            color: #00a8ff;
            margin-bottom: 20px;
        }
        
        .video-placeholder h3 {
            font-size: 32px;
            margin-bottom: 10px;
            color: #fff;
        }
        
        .video-placeholder p {
            font-size: 18px;
            color: #ccc;
            max-width: 600px;
            line-height: 1.5;
        }
        
        /* Floating Telegram button */
        .telegram-float {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }
        
        .telegram-btn {
            width: 70px;
            height: 70px;
            background: linear-gradient(135deg, #0088cc, #34b7f1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 6px 20px rgba(0, 136, 204, 0.5);
            cursor: pointer;
            transition: all 0.3s ease;
            animation: pulse 2s infinite;
            text-decoration: none;
        }
        
        .telegram-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(0, 136, 204, 0.7);
        }
        
        .telegram-btn i {
            font-size: 36px;
            color: white;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(0, 136, 204, 0.7); }
            70% { box-shadow: 0 0 0 15px rgba(0, 136, 204, 0); }
            100% { box-shadow: 0 0 0 0 rgba(0, 136, 204, 0); }
        }
        
        /* Channel info overlay */
        .channel-info {
            position: fixed;
            bottom: 30px;
            left: 30px;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px 20px;
            border-radius: 10px;
            border-left: 4px solid #00a8ff;
            z-index: 100;
            max-width: 300px;
            backdrop-filter: blur(5px);
        }
        
        .channel-name {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 5px;
            color: #00a8ff;
        }
        
        .channel-event {
            font-size: 16px;
            color: #fff;
            margin-bottom: 8px;
        }
        
        .channel-status {
            font-size: 14px;
            color: #44bd32;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* Ad containers */
        .ad-container {
            position: fixed;
            z-index: 200;
            width: 100%;
        }
        
        .ad-top {
            top: 0;
            left: 0;
            width: 100%;
            height: 100px;
            background: rgba(10, 10, 10, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            border-bottom: 1px solid #333;
        }
        
        .ad-bottom {
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100px;
            background: rgba(10, 10, 10, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            border-top: 1px solid #333;
        }
        
        .ad-label {
            position: absolute;
            top: 5px;
            right: 5px;
            background-color: rgba(255, 255, 255, 0.1);
            color: #ccc;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 3px;
        }
        
        /* Loading animation */
        .loader {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(0, 168, 255, 0.2);
            border-top: 5px solid #00a8ff;
            border-radius: 50%;
            margin: 20px auto;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Hide shaka player time display */
        .shaka-current-time, .shaka-time-container { 
            display: none !important; 
        }
        
        .shaka-spinner-container { 
            display: none !important; 
        }
        
        /* Responsive design */
        @media (max-width: 768px) {
            .watermark {
                width: 80px;
                top: 10px;
                left: 10px;
            }
            
            .video-placeholder h3 {
                font-size: 24px;
            }
            
            .video-placeholder p {
                font-size: 16px;
                padding: 0 15px;
            }
            
            .telegram-float {
                bottom: 20px;
                right: 20px;
            }
            
            .telegram-btn {
                width: 60px;
                height: 60px;
            }
            
            .telegram-btn i {
                font-size: 28px;
            }
            
            .channel-info {
                bottom: 20px;
                left: 20px;
                max-width: 250px;
                padding: 12px 15px;
            }
            
            .channel-name {
                font-size: 18px;
            }
            
            .channel-event {
                font-size: 14px;
            }
            
            .ad-top, .ad-bottom {
                height: 80px;
            }
        }
        
        @media (max-width: 480px) {
            .channel-info {
                bottom: 100px;
                max-width: 200px;
            }
            
            .ad-top, .ad-bottom {
                height: 70px;
            }
        }
    </style>
</head>
<body>
    <!-- Watermark -->
    <img src="https://i.imgur.com/LofbqIP.png" alt="SportsPro" class="watermark">
    
    <!-- Top Ad -->
    <div class="ad-container ad-top">
        <div class="ad-label">Advertisement</div>
        <!-- Adsterra Banner Ad Code -->
        <div id="container-ad-top"></div>
    </div>
    
    <!-- Player Container -->
    <div class="player-container">
        <div data-shaka-player-container style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;">
            <div class="video-placeholder" id="video-placeholder">
                <i class="fas fa-satellite-dish"></i>
                <h3>SportsPro Live Stream</h3>
                <p>High-quality live streaming. The player will load automatically.</p>
                <div class="loader"></div>
                <p style="margin-top: 20px; font-size: 14px; color: #aaa;">
                    If the stream doesn't load, please refresh the page
                </p>
            </div>
            <video autoplay muted data-shaka-player id="video" poster="https://imgur.com/LofbqIP" style="width:100%; height:100%; display: none;"></video>
        </div>
    </div>
    
    <!-- Channel Info -->
    <div class="channel-info">
        <div class="channel-name">SPORTS PRO LIVE</div>
        <div class="channel-event">Live Sports Streaming 24/7</div>
        <div class="channel-status">
            <i class="fas fa-circle" style="font-size: 10px;"></i>
            <span>LIVE NOW</span>
        </div>
    </div>
    
    <!-- Bottom Ad -->
    <div class="ad-container ad-bottom">
        <div class="ad-label">Advertisement</div>
        <!-- Adsterra Banner Ad Code -->
        <div id="container-ad-bottom"></div>
    </div>
    
    <!-- Floating Telegram Button -->
    <div class="telegram-float">
        <a href="https://t.me/sportsproweb" target="_blank" class="telegram-btn">
            <i class="fab fa-telegram"></i>
        </a>
    </div>
    
    <!-- Shaka Player Script -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.7.1/shaka-player.ui.min.js" crossorigin="anonymous"></script>
    
    <!-- Adsterra Ad Scripts -->
    <script type="text/javascript">
        // Adsterra Ad Code Placeholders
        // Replace these with actual Adsterra codes from your account
        
        // Top banner ad
        var atOptions_top = {
            'key' : 'your_top_banner_key_here',
            'format' : 'iframe',
            'height' : 90,
            'width' : 728,
            'params' : {}
        };
        
        // Bottom banner ad
        var atOptions_bottom = {
            'key' : 'your_bottom_banner_key_here',
            'format' : 'iframe',
            'height' : 90,
            'width' : 728,
            'params' : {}
        };
        
        // Popunder ad (will be triggered after page load)
        var atOptions_pop = {
            'key' : 'your_popunder_key_here',
            'format' : 'iframe',
            'height' : 600,
            'width' : 160,
            'params' : {}
        };
        
        // Function to load ads
        function loadAds() {
            // Load top banner
            document.getElementById('container-ad-top').innerHTML = 
                '<div style="background:rgba(26, 26, 46, 0.9); color:#fff; padding:15px; border-radius:5px; text-align:center; width:728px; height:90px; display:flex; align-items:center; justify-content:center;">' +
                '<div>Adsterra Top Banner Ad (728x90)<br><small>Replace with actual Adsterra code</small></div>' +
                '</div>';
            
            // Load bottom banner
            document.getElementById('container-ad-bottom').innerHTML = 
                '<div style="background:rgba(26, 26, 46, 0.9); color:#fff; padding:15px; border-radius:5px; text-align:center; width:728px; height:90px; display:flex; align-items:center; justify-content:center;">' +
                '<div>Adsterra Bottom Banner Ad (728x90)<br><small>Replace with actual Adsterra code</small></div>' +
                '</div>';
            
            // Trigger popunder ad after 10 seconds
            setTimeout(function() {
                // This is where the actual Adsterra popunder code would go
                console.log("Popunder ad would trigger here");
                
                // For demo, we'll just log it
                var popunderHtml = '<div style="display:none;">Popunder ad placeholder</div>';
                var div = document.createElement('div');
                div.innerHTML = popunderHtml;
                document.body.appendChild(div);
            }, 10000);
        }
    </script>
    
    <!-- Main Player Script - SIMPLIFIED AND WORKING -->
    <script>
        // Define the MPD URL and keys (using the decoded values from original code)
        const mpdUrl = 'https://otn.live.cf.2lvwuvx3qnbwduu6.workers.dev/bom-30201/dash/enc/cenc.mpd';
        const kid = 'd0f2e5c39e4bb1ab469370c18f29bf9a';
        const key = 'f37a18905fd6853c51fc3b0c314fffd7';
        
        let player, ui;
        
        // Initialize the player
        async function initApp() {
            try {
                // Install shaka polyfills
                await shaka.polyfill.installAll();
                
                // Check if browser supports basic features
                if (shaka.Player.isBrowserSupported()) {
                    console.log('Shaka Player is supported in this browser');
                    
                    // Get video element and container
                    const videoElement = document.getElementById('video');
                    const videoContainer = document.querySelector('[data-shaka-player-container]');
                    
                    // Create player
                    player = new shaka.Player(videoElement);
                    window.player = player; // Make player accessible globally
                    
                    // Configure player with DRM
                    const playerConfig = {
                        drm: {
                            clearKeys: {
                                [kid]: key
                            }
                        },
                        streaming: {
                            bufferingGoal: 30,
                            rebufferingGoal: 10
                        }
                    };
                    
                    player.configure(playerConfig);
                    
                    // Set up error handling
                    player.addEventListener('error', onPlayerError);
                    
                    // Load the stream
                    try {
                        await player.load(mpdUrl);
                        console.log('Video has now been loaded!');
                        
                        // Hide placeholder and show video
                        document.getElementById('video-placeholder').style.display = 'none';
                        videoElement.style.display = 'block';
                        
                        // Initialize UI controls
                        initializeUI(videoContainer, videoElement);
                        
                    } catch (e) {
                        console.error('Error loading video:', e);
                        showError('Failed to load the stream. The server might be down.');
                    }
                } else {
                    console.error('Shaka Player is not supported in this browser');
                    showError('Your browser does not support this video player.');
                }
            } catch (error) {
                console.error('Error initializing player:', error);
                showError('Failed to initialize player.');
            }
        }
        
        function initializeUI(container, videoElement) {
            // Create UI controls
            ui = new shaka.ui.Overlay(player, container, videoElement);
            
            // Configure UI
            const controls = ui.getControls();
            
            // Hide the time display if needed
            const timeContainer = container.querySelector('.shaka-time-container');
            if (timeContainer) {
                timeContainer.style.display = 'none';
            }
            
            // Hide current time display
            const currentTime = container.querySelector('.shaka-current-time');
            if (currentTime) {
                currentTime.style.display = 'none';
            }
        }
        
        function onPlayerError(event) {
            console.error('Player error:', event.detail);
            
            // Show error message
            const errorCode = event.detail.code;
            let errorMessage = 'An error occurred while playing the stream.';
            
            if (errorCode === 1001 || errorCode === 1002) {
                errorMessage = 'Network error. Please check your connection.';
            } else if (errorCode === 4003 || errorCode === 4007) {
                errorMessage = 'DRM error. The stream might be encrypted.';
            } else if (errorCode === 4012) {
                errorMessage = 'Video format not supported.';
            }
            
            showError(errorMessage);
        }
        
        function showError(message) {
            const placeholder = document.getElementById('video-placeholder');
            placeholder.innerHTML = `
                <i class="fas fa-exclamation-triangle" style="color:#e74c3c; font-size: 60px; margin-bottom: 20px;"></i>
                <h3>Stream Error</h3>
                <p>${message}</p>
                <button onclick="retryStream()" style="margin-top: 20px; padding: 10px 25px; background: #00a8ff; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 16px;">
                    <i class="fas fa-redo"></i> Retry Stream
                </button>
                <p style="margin-top: 15px; font-size: 14px; color: #aaa;">
                    If the problem persists, try refreshing the page
                </p>
            `;
            placeholder.style.display = 'flex';
        }
        
        function retryStream() {
            const placeholder = document.getElementById('video-placeholder');
            placeholder.innerHTML = `
                <i class="fas fa-satellite-dish"></i>
                <h3>SportsPro Live Stream</h3>
                <p>Reconnecting to stream...</p>
                <div class="loader"></div>
            `;
            
            // Try to reload the player
            if (player) {
                player.unload();
                setTimeout(() => {
                    player.load(mpdUrl).then(() => {
                        placeholder.style.display = 'none';
                        document.getElementById('video').style.display = 'block';
                    }).catch(error => {
                        showError('Still unable to connect. Please try again later.');
                    });
                }, 1000);
            } else {
                // If player doesn't exist, reload the page
                location.reload();
            }
        }
        
        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Load ads first
            loadAds();
            
            // Initialize player after a short delay
            setTimeout(initApp, 1000);
        });
        
        // Also try to initialize if page is already loaded
        if (document.readyState === 'complete' || document.readyState === 'interactive') {
            setTimeout(initApp, 1000);
        }
    </script>
</body>
</html>